<section class="content-header">
    <h1>Dashboard </h1>
    <div id="txt" class="pull-right"></div>
    <h1 class="pull-right" id="currentDate"></h1>
</section>

<section class="content">
    {{#if message}}
        <div class="alert alert-danger">{{message}}</div>
    {{/if}}

    <div class="row">
        <div class="col-md-12">
            <div class="box box-info">
                <div class="box-header with-border">
                    <h3 class="box-title">Patient List</h3>

                    <div class="box-tools pull-right">
                        <button type="button" class="btn btn-box-tool" data-widget="collapse"><i
                                class="fa fa-minus"></i>
                        </button>
                    </div>
                </div>
                <!-- /.box-header -->
                <div class="box-body">
                    <div class="table-responsive">
                        <table class="table no-margin">
                            <thead>
                            <tr>
                                <th>Name</th>
                                <th>Doctor</th>
                                <th>Appointment Time</th>
                                <th>Check In Time</th>
                                <th>Status</th>
                            </tr>
                            </thead>
                            <tbody id="appointment-list">
                            <tr>

                                <td>Gev</td>
                                <td>Henry</td>
                                <td>10:40AM</td>
                                <td style="color: red">10:54AM</td>
                                <td>Lobby</td>
                            </tr>
                            <tr>

                                <td>Yen</td>
                                <td>Henry</td>
                                <td>11:00AM</td>
                                <td style="color: rgba(26, 128, 15, 0.83)">10:36AM</td>
                                <td>Checked In</td>
                            </tr>
                            <tr>

                                <td>Jax</td>
                                <td>Andrew</td>
                                <td>9:30AM</td>
                                <td></td>
                                <td></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                    <!-- /.table-responsive -->
                </div>
                <!-- /.box-body -->
                <div class="box-footer clearfix">
                    <a href="#" class="btn btn-sm btn-success btn-flat pull-right">Check In</a>
                    <a href="#" class="btn btn-sm btn-warning btn-flat pull-right">Check Out</a>
                    <a href="#" class="btn btn-sm btn-info btn-flat pull-right">Reschedule</a>
                </div>
                <!-- /.box-footer -->
            </div>
        </div>
    </div>
</section>

<script src="/socket.io/socket.io.js"></script>
<script>
  var socket = io('http://localhost:4005');
  socket.on('checkin', function (data) {
    console.log(data);

    var apptList = document.getElementById('appointment-list');
    var appointment = document.createElement("tr");

    var visitorField = document.createElement("td");
    visitorField.appendChild( document.createTextNode(data.visitor) );
    appointment.appendChild(visitorField);

    var doctorField = document.createElement("td");
    doctorField.appendChild( document.createTextNode(data.doctor) );
    appointment.appendChild(doctorField);

    var apptTime = document.createElement("td");
    apptTime.appendChild( document.createTextNode(data.apptTime) );
    appointment.appendChild(apptTime);

    var time = new Date();
    var currTime = document.createElement("td");
    currTime.appendChild( document.createTextNode(data.currentTime) );
    appointment.appendChild(currTime);

    var status = document.createElement("td");
    status.appendChild( document.createTextNode(data.status) );
    appointment.appendChild(status);

    apptList.appendChild(appointment);
    
  });
</script>